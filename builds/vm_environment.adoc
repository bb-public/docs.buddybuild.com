= Virtualization environment

Each build that buddybuild undertakes for your projects is executed in a
virtualized environment (using virtual machines, or VMs). This section
describes the VMs and the installed tools available for your use.

For each build, buddybuild constructs a fresh VM from a snapshot. This
means that there is no state that exists between builds, and every build
starts from a known, consistent state. At the end of a build, the VM is
destroyed -- usually, this happens immediately after all build artifacts
have been retrieved, but can be delayed by up to 20 minutes if SSH
access is enabled. FIXME

== Virtualization variants

There are platform-specific VMs available, one each for Android and iOS
builds:

- A Docker container for Android builds.
- A FIXME container for iOS builds.

Here is a summary of each of the environments:

[cols="10a,14a,14a", options="header"]
|===
| Feature
| iOS
| Android

| Base operating system
| Mac OS Sierra, El Capitan, or Yosemite (<<macos,see below>>)
| Debian GNU/Linux 8 (jessie)

| Memory
| 8 GB
| 8 GB

| CPU cores
| 2
| 2

| Available disk space
| 20 GB-50 GB (sparse allocation)
| 20 GB-50 GB (sparse allocation)

| File system
|
- HFS+,
- case insensitive
- Spotlight disabled
- boot cache cleared before boot

|
- AUFS
- case sensitive

| Network location
| East coast US. +
More locations coming...

| West coast US. +
More locations coming...
|===


[[macos]]
=== macOS variants

While most builds can run on macOS Sierra, older versions of Xcode
require older versions of macOS:

[cols="1a,3a", options="header"]
|===
| Xcode
| macOS

| 6.x
| Yosemite (10.10)

| 7.x
| El Capitan (10.11)

| 8.x, 9 beta
| Sierra (10.12)
|===

An appropriate VM with the matching version of macOS is used depending
on the version of Xcode that you select in the build configuration for
your project.


== Networking

The VMs have IPv4 networking enabled; IPv6 is not currently available.

The VMs are all on NAT networks; they are not accessible via external IP
addresses, but they are able to communicate externally with no imposed
restrictions. The list of external IP addresses that buddybuild uses is
available via our
link:http://apidocs.buddybuild.com/misc/get-ip_ranges.html[REST API].

[NOTE]
Buddybuild VMs cannot contact each other. However, several classes of
buddybuild internal servers do contact the VMs, to prepare a VM for a
build, to provide credentials, keys, and other secrets, and to collect
build artifacts before the VM is destroyed.

If you need to stand up a service to complete your builds, most such
services work as expected when talking to `localhost` or `127.0.0.1`.

When you start a build with SSH enabled, SSH is configured to use the
key you provide to us. Password authentication is disabled.

Finally, if you host your source code on a private network, talk to us
to discuss custom network configurations. We can work with your network
administrators to build a secure connection between your network and our
network(s) using facilities such as bi-directional NAT, mutual
certificate authentication, and site-to-site VPN.


== Installed tools

The following tools are installed in each VM:

[cols="10a,14a,14a", options="header"]
|===
|
| iOS
| Android

3+h| Android

| SDK
| Not available
| <<android-sdk,See below>>

| NDK
| Not available
| <<android-ndk,See below>>

3+h| Compilers

| Clang / Clang++
| 9.0.0
| FIXME

| gcc
| 9.0.0 (Clang)
| FIXME

| xcode-select
| 2347
| Not available

| xcodebuild
| 9.0 9M189t
| Not available

3+h| Editors

| Nano
| 2.0.6
| FIXME

| Vim
| 7.4
| FIXME

3+h| Java

| Java
| 1.7.0_79
| FIXME

3+h| Javascript

| npm
| 5.3.0
| FIXME

| n
| 2.1.7
| FIXME

| yarn
| 0.18.1
| FIXME

| Installed modules
| None
| FIXME

3+h| Perl

| Perl
| 5.18
| FIXME

| cpan
| 1.61
| FIXME

3+h| Python

| Python
| 2.7.10
| FIXME

3+h| Ruby

| Ruby
| 2.0.0p648
| FIXME

| chruby
| 0.3.9
| FIXME

| Installed Gems
|
- CFPropertyList (2.3.5, 2.2.8)
- activesupport (4.2.9)
- addressable (2.5.1, 2.3.8)
- aws-sdk (2.8.14)
- aws-sdk-core (2.8.14)
- aws-sdk-resources (2.8.14)
- aws-sigv4 (1.0.1)
- babosa (1.0.2)
- bigdecimal (default: 1.2.0)
- bundler (1.15.3)
- claide (1.0.2)
- claide-plugins (0.9.2)
- cocoapods (1.1.1)
- cocoapods-core (1.1.1)
- cocoapods-deintegrate (1.0.1)
- cocoapods-downloader (1.1.3)
- cocoapods-plugins (1.0.0)
- cocoapods-search (1.0.0)
- cocoapods-stats (1.0.0)
- cocoapods-trunk (1.2.0)
- cocoapods-try (1.1.0)
- colored (1.2)
- colored2 (3.1.2)
- commander (4.4.3)
- commander-fastlane (4.4.5)
- cork (0.3.0)
- credentials_manager (1.0.0)
- danger (3.2.1)
- domain_name (0.5.20170404)
- dotenv (2.2.1)
- escape (0.0.4)
- excon (0.57.1)
- faraday (0.12.2)
- faraday-cookie_jar (0.0.6)
- faraday-http-cache (1.3.1)
- faraday_middleware (0.12.0)
- fastimage (2.1.0, 1.9.0)
- fastlane (2.23.0)
- ffi (1.9.18)
- fourflusher (2.0.1)
- fuzzy_match (2.0.4)
- gh_inspector (1.0.3)
- git (1.3.0)
- gitlab (3.7.0)
- google-api-client (0.9.28)
- googleauth (0.5.3)
- highline (1.7.8)
- http-cookie (1.0.3)
- httparty (0.13.7)
- httpclient (2.8.3)
- hurley (0.2)
- i18n (0.8.6)
- io-console (default: 0.4.2)
- jazzy (0.8.3)
- jmespath (1.3.1)
- json (1.8.6, default: 1.7.7)
- jwt (1.5.6)
- kramdown (1.14.0)
- libxml-ruby (2.6.0)
- liferaft (0.0.6)
- little-plugger (1.1.4)
- logging (2.2.2)
- memoist (0.16.0)
- mime-types (3.1)
- mime-types-data (3.2016.0521)
- mini_magick (4.5.1)
- mini_portile2 (2.1.0)
- minitest (5.10.3, default: 4.3.2)
- molinillo (0.5.7)
- multi_json (1.12.1)
- multi_xml (0.6.0)
- multipart-post (2.0.0)
- mustache (0.99.8)
- nanaimo (0.2.3)
- nap (1.1.0)
- netrc (0.7.8)
- nokogiri (1.6.8.1, 1.5.6)
- octokit (4.7.0, 4.6.2)
- open4 (1.3.4)
- os (0.9.6)
- plist (3.3.0)
- psych (default: 2.0.0)
- public_suffix (2.0.5)
- rake (default: 0.9.6)
- rb-fsevent (0.10.2)
- rb-inotify (0.9.10)
- rdoc (default: 4.0.0)
- redcarpet (3.4.0)
- representable (2.3.0)
- retriable (2.1.0)
- rouge (2.0.7, 1.11.1)
- rubygems-update (2.6.12)
- rubyzip (1.2.1)
- sass (3.5.1)
- sass-listen (4.0.0)
- sawyer (0.8.1)
- security (0.1.3)
- signet (0.7.3)
- slack-notifier (1.5.1)
- spaceship (0.28.0)
- sqlite3 (1.3.7)
- terminal-notifier (1.8.0)
- terminal-table (1.8.0, 1.4.5)
- test-unit (default: 2.0.0.0)
- thread_safe (0.3.6)
- tty-screen (0.5.0)
- tzinfo (1.2.3)
- uber (0.0.15)
- unf (0.1.4)
- unf_ext (0.0.7.4)
- unicode-display_width (1.3.0)
- word_wrap (1.0.0)
- xcinvoke (0.3.0)
- xcodeproj (1.5.1)
- xcpretty (0.2.8)
- xcpretty-travis-formatter (0.0.4)
| FIXME

3+h| Tools

| Homebrew
| 1.2.6
| Not available

3+h| Versioning

| Git
| 2.13.3
| FIXME

| Subversion
| 1.9.4
| FIXME

| Mercurial
| 4.2.2
| FIXME

|===


[android-sdk]
== Android SDK

[cols="1a,3a"]
|===
| build tools
| 17.0.0 +
18.0.1 +
18.1.0 +
18.1.1 +
19.0.0 +
19.0.1 +
19.0.2 +
19.0.3 +
19.1.0 +
20.0.0 +
21.0.0 +
21.0.1 +
21.0.2 +
21.1.0 +
21.1.1 +
21.1.2 +
22.0.0 +
22.0.1 +
23.0.0 +
23.0.1 +
23.0.2 +
23.0.3 +
24.0.0 +
24.0.1

| platforms
| android-10 +
android-11 +
android-12 +
android-13 +
android-14 +
android-15 +
android-16 +
android-17 +
android-18 +
android-19 +
android-20 +
android-21 +
android-22 +
android-23 +
android-24

| system-images
| android-22/default/armeabi-v7a +
android-22/default/x86_64 +
android-22/google_apis/armeabi-v7a +
android-22/google_apis/x86_64 +
android-23/default/armeabi-v7a +
android-23/default/x86_64 +
android-23/google_apis/armeabi-v7a +
android-23/google_apis/x86_64

| extras/m2repository
| com/android/support/constraint/constraint-layout/1.0.0-alpha8 +
com/android/support/constraint/constraint-layout/1.0.0-alpha7 +
com/android/support/constraint/constraint-layout/1.0.0-alpha6 +
com/android/support/constraint/constraint-layout/1.0.0-alpha5 +
com/android/support/constraint/constraint-layout/1.0.0-alpha4 +
com/android/support/constraint/constraint-layout/1.0.0-alpha3 +
com/android/support/constraint/constraint-layout/1.0.0-alpha2 +
com/android/support/constraint/constraint-layout-solver/1.0.0-alpha8 +
com/android/support/constraint/constraint-layout-solver/1.0.0-alpha7 +
com/android/support/constraint/constraint-layout-solver/1.0.0-alpha6 +
com/android/support/constraint/constraint-layout-solver/1.0.0-alpha5 +
com/android/support/constraint/constraint-layout-solver/1.0.0-alpha4 +
com/android/support/constraint/constraint-layout-solver/1.0.0-alpha3 +
com/android/support/constraint/constraint-layout-solver/1.0.0-alpha2 +
com/android/support/constraint/constraint-layout-solver +
com/android/support/constraint/constraint-layout
|===


[android-ndk]
== Android NDK

"android-ndk-r10e" is pre-installed on the box.
